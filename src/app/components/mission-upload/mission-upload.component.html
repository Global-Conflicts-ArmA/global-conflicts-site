<div class="content">
	<div style="position: relative">
		<div class="not-allowed-text" *ngIf="!(discordUser && discordUser.role)">
			You must join our Discord server and complete the welcoming process to upload missions!
		</div>

		<div class="column" [class.not-allowed-overlay]="!(discordUser && discordUser.role)">
			<div class="explain" *ngIf="discordUser">
				• The name of your mission on the server will be a composition of the options you choose bellow. The file name of
				the mission on your PC is irrelevant.
				<div *ngIf="discordUser.isTrustedMissionMaker()">
					• You are trusted mission maker! Your mission will be uploaded to the "MPMissions" folder of the Test Server.
				</div>
				<div *ngIf="!discordUser.isTrustedMissionMaker()">
					• You are not trusted mission maker(yet)! Your mission will be uploaded to the "READY" folder of the Test
					Server.
				</div>
			</div>
			<div class="mission-file-name-result">
				Mission file name: <b>{{missionFileName}}</b>
			</div>
			<div class="mission-desc-result">
				Description: <b>{{missionDescription}}</b>
			</div>
			<div class="mission-desc-result">
				Image: <img [src]="missionImageSrc" *ngIf="missionImageSrc" width="500" style="max-width:500px; height:auto; max-height:600px;">
			</div>
			<mat-vertical-stepper class="field-container" [linear]="false" #stepper>
			  <mat-step [stepControl]="fileUploadGroup">
			    <form [formGroup]="fileUploadGroup">
			      <ng-template matStepLabel>Mission File</ng-template>
						<div>
							<mat-form-field>
				        <mat-label class="inset-label" for="file-input">Select Mission .pbo</mat-label>
				        <ngx-mat-file-input formControlName="missionFile" valuePlaceholder="No file selected"
				        	required [accept]="'.pbo'" [errorStateMatcher]="ErrorStateMatcher" #missionFile
									(change)="missionToUpload = $event.target.files[0]; buildMissionFileName()"
								>
				        </ngx-mat-file-input>
								<mat-icon color="white" matSuffix>folder</mat-icon>
								<button mat-icon-button *ngIf="!missionFile.empty" (click)="missionFile.clear($event); missionToUpload = null;">
									<mat-icon matSuffix>clear</mat-icon> Clear Selection
								</button>
								<mat-error>{{getFileErrorMessage()}}</mat-error>
				      </mat-form-field>
						</div>
						<button mat-button matStepperNext>Next</button>
			    </form>
			  </mat-step>
				<mat-step [stepControl]="missionNameGroup">
			    <form [formGroup]="missionNameGroup">
			      <ng-template matStepLabel>Mission Name</ng-template>
						<div>
							<mat-form-field>
				        <mat-label class="inset-label">Mission Name</mat-label>
				        <input matInput formControlName="missionName" maxlength="31" placeholder="Operation Boomstick" required
									autocomplete="off" id="name" (ngModelChange)="buildMissionFileName()"
								>
								<mat-error>{{getNameErrorMessage()}}</mat-error>
				      </mat-form-field>
						</div>
						<button mat-button matStepperNext>Next</button>
			    </form>
			  </mat-step>
				<mat-step [stepControl]="missionTypeGroup">
	        <form [formGroup]="missionTypeGroup">
							<ng-template matStepLabel>Mission Type</ng-template>
							<div class="mt-2">
								<mat-radio-group formControlName="missionType" #missionType
									(ngModelChange)="selectMissionType(); buildMissionFileName()" required
								>
									<mat-radio-button *ngFor="let type of mC.MissionTypes" [value]="type" >
										{{type.title}}
									</mat-radio-button>
								</mat-radio-group>
							</div>
							<mat-error>{{getTypeErrorMessage()}}</mat-error>
							<button mat-button matStepperNext>Next</button>
	        </form>
        </mat-step>
				<mat-step [stepControl]="missionSizeGroup">
			    <form [formGroup]="missionSizeGroup">
			      <ng-template matStepLabel>Player Count</ng-template>
						<div>
							<mat-form-field>
				        <mat-label class="inset-label">Minimum Players</mat-label>
				        <input matInput formControlName="minPlayers" autocomplete="off" placeholder="10" type="number" id="minPlayers"
									#minSizeInput maxlength="3" (ngModelChange)="minPlayers = minSizeInput.value; buildMissionFileName()"
								>
				      </mat-form-field>
							<mat-form-field>
				        <mat-label class="inset-label">Maximum Players</mat-label>
				        <input matInput formControlName="maxPlayers" autocomplete="off" placeholder="22" type="number" id="maxPlayers"
									#maxSizeInput maxlength="3" (ngModelChange)="maxPlayers = maxSizeInput.value; buildMissionFileName()"
								>
								<mat-error>{{getSizeErrorMessage()}}</mat-error>
				      </mat-form-field>
						</div>
						<button mat-button matStepperNext>Next</button>
			    </form>
			  </mat-step>
				<mat-step [stepControl]="missionEraGroup">
			    <form [formGroup]="missionEraGroup">
			      <ng-template matStepLabel>Era</ng-template>
						<div>
							<mat-radio-group formControlName="missionEra" #missionEra
								required
							>
								<ul>
									<li *ngFor="let era of mC.MissionEras">
										<mat-radio-button [value]="era">
											{{era}}
										</mat-radio-button>
									</li>
								</ul>
							</mat-radio-group>
						</div>
						<button mat-button matStepperNext>Next</button>
			    </form>
			  </mat-step>
				<mat-step [stepControl]="missionDescGroup">
			    <form [formGroup]="missionDescGroup">
			      <ng-template matStepLabel>Description</ng-template>
						<div>
							<mat-form-field *ngIf="getIfTVT()">
				        <mat-label class="inset-label">Ratio</mat-label>
				        <textarea matInput formControlName="misRatio" autocomplete="off" placeholder="2.5:1" type="string"
									#misRatio maxlength="14" id="misRatio" (ngModelChange)="buildMissionDesc()"
								></textarea>
								<mat-error>{{getRatioErrorMessage()}}</mat-error>
				      </mat-form-field>
							<mat-form-field>
				        <mat-label class="inset-label">Description</mat-label>
				        <textarea matInput formControlName="misDescription" autocomplete="off" placeholder="USMC raids ammo depot | Defenders chooses weather" type="string"
									#misDescription maxlength="100" id="misDescription" (ngModelChange)="buildMissionDesc()"
								></textarea>
								<mat-error>{{getDescErrorMessage()}}</mat-error>
				      </mat-form-field>
						</div>
						<button mat-button matStepperNext>Next</button>
			    </form>
			  </mat-step>
				<mat-step [stepControl]="fileImageGroup">
			    <form [formGroup]="fileImageGroup">
			      <ng-template matStepLabel>Image</ng-template>
						<div>
							<mat-form-field>
				        <mat-label class="inset-label" for="file-input">Select Image</mat-label>
				        <ngx-mat-file-input formControlName="missionImage" #missionImage valuePlaceholder="No file selected"
				        	[accept]="['.png', '.jpg', '.jpeg']" (change)="missionImageFile = $event.target.files[0]; setImagePreview($event.target.files[0])" required
								>
				        </ngx-mat-file-input>
								<mat-icon color="white" matSuffix>add_photo_alternate</mat-icon>
								<button mat-icon-button *ngIf="!missionImage.empty" (click)="missionImage.clear($event); missionImageFile = null; missionImageSrc = null">
									<mat-icon matSuffix>clear</mat-icon> Clear Selection
								</button>
								<mat-error>{{getImageErrorMessage()}}</mat-error>
				      </mat-form-field>
						</div>
						<button mat-button matStepperNext>Next</button>
			    </form>
			  </mat-step>
			  <mat-step>
			    <ng-template matStepLabel>Done</ng-template>
			    <p>You are now done.</p>
			    <div>
			      <button mat-button matStepperPrevious>Back</button>
			      <button mat-button (click)="stepper.reset()">Reset</button>
			    </div>
			  </mat-step>
			</mat-vertical-stepper>
		</div>
	</div>
</div>
