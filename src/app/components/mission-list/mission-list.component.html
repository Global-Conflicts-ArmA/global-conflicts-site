<div class="not-allowed-text" *ngIf="!(discordUser && discordUser.role)">
	You must join our Discord server and complete the welcoming process to see our mission list!
</div>
<div class="flexrow" [class.not-allowed-overlay]="!(discordUser && discordUser?.role)">
	<div class="controlsColumn">
		<div class="controlsContainer" [formGroup]="filterGroup">
			<mat-form-field class="searchFilter mt-4">
				<mat-label>Search Filter</mat-label>
				<input matInput (keyup)="applyFilter($event)" placeholder="Search Term" #input>
			</mat-form-field>
			<mat-form-field appearance="fill">
				<mat-label>Author:</mat-label>
				<mat-select value="ALL" formControlName="misAuthor" (selectionChange)="applyFilter($event)">
					<mat-option value="ALL">ALL</mat-option>
					<mat-option *ngFor="let author of userList" [value]="author">{{author}}</mat-option>
				</mat-select>
			</mat-form-field>
			<mat-form-field appearance="fill">
				<mat-label>Type:</mat-label>
				<mat-select value="ALL" formControlName="misType" (selectionChange)="applyFilter($event)">
					<mat-option value="ALL">ALL</mat-option>
					<mat-option *ngFor="let type of mC.MissionTypes" [value]="type.title">{{type.title}}</mat-option>
				</mat-select>
			</mat-form-field>
			<mat-form-field appearance="fill">
				<mat-label>Terrain:</mat-label>
				<mat-select value="ALL" formControlName="misTerrain" (selectionChange)="applyFilter($event)">
					<mat-option value="ALL">ALL</mat-option>
					<mat-option *ngFor="let item of terrainList" [value]="item">{{item}}</mat-option>
				</mat-select>
			</mat-form-field>
			<mat-form-field appearance="fill">
				<mat-label>Time:</mat-label>
				<mat-select value="ALL" formControlName="misTime" (selectionChange)="applyFilter($event)">
					<mat-option value="ALL">ALL</mat-option>
					<mat-option *ngFor="let time of mC.MissionTimes" [value]="time">{{time}}</mat-option>
				</mat-select>
			</mat-form-field>
			<mat-form-field appearance="fill">
				<mat-label>Era:</mat-label>
				<mat-select value="ALL" formControlName="misEra" (selectionChange)="applyFilter($event)">
					<mat-option value="ALL">ALL</mat-option>
					<mat-option *ngFor="let era of mC.MissionEras" [value]="era">{{era}}</mat-option>
				</mat-select>
			</mat-form-field>
			<mat-form-field>
				<mat-label>Tags</mat-label>
				<mat-select formControlName="misTags" multiple #missionTags (selectionChange)="applyFilterTags()">
					<mat-select-trigger>
						<mat-chip-list>
							<mat-chip
								*ngFor="let tag of filterGroup.get('misTags')?.value; let matChipIndex = index"
								[removable]="true" (removed)="onListChipRemoved(missionTags, matChipIndex)">
								{{ tag }}
								<mat-icon matChipRemove>cancel</mat-icon>
							</mat-chip>
						</mat-chip-list>
					</mat-select-trigger>
					<mat-option *ngFor="let tag of mC.MissionTags" [value]="tag">{{tag}}
					</mat-option>
				</mat-select>
			</mat-form-field>
		</div>
	</div>
	<div class="tableColumn mr-2">
		<table mat-table [dataSource]="this.dataSource" class="matTable" matSort>
			<ng-container matColumnDef="name">
				<th mat-header-cell *matHeaderCellDef mat-sort-header> Name </th>
				<td mat-cell *matCellDef="let element">{{element.name}}</td>
			</ng-container>
			<ng-container matColumnDef="type">
				<th mat-header-cell *matHeaderCellDef mat-sort-header> Type </th>
				<td mat-cell *matCellDef="let element">{{element.type}}</td>
			</ng-container>
			<ng-container matColumnDef="size.min">
				<th mat-header-cell *matHeaderCellDef mat-sort-header> Min </th>
				<td mat-cell *matCellDef="let element">{{element.size.min}}</td>
			</ng-container>
			<ng-container matColumnDef="size.max">
				<th mat-header-cell *matHeaderCellDef mat-sort-header> Max </th>
				<td mat-cell *matCellDef="let element">{{element.size.max}}</td>
			</ng-container>
			<ng-container matColumnDef="terrain">
				<th mat-header-cell *matHeaderCellDef mat-sort-header> Terrain </th>
				<td mat-cell *matCellDef="let element">{{missionsService.getTerrainData(element.terrain).name}}</td>
			</ng-container>
			<ng-container matColumnDef="era">
				<th mat-header-cell *matHeaderCellDef mat-sort-header> Era </th>
				<td mat-cell *matCellDef="let element">{{element.era}}</td>
			</ng-container>
			<ng-container matColumnDef="authorName">
				<th mat-header-cell *matHeaderCellDef mat-sort-header> Author </th>
				<td mat-cell *matCellDef="let element">{{element.authorName}}</td>
			</ng-container>
			<ng-container matColumnDef="version">
				<th mat-header-cell *matHeaderCellDef mat-sort-header> Version </th>
				<td mat-cell *matCellDef="let element">{{element.version}}</td>
			</ng-container>
			<ng-container matColumnDef="lastUpdate">
				<th mat-header-cell *matHeaderCellDef mat-sort-header> Last Updated </th>
				<td mat-cell *matCellDef="let element">{{missionsService.getDate(element.lastUpdate)}}</td>
			</ng-container>
			<tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
			<tr mat-row *matRowDef="let row; columns: displayedColumns;" (click)="onActivate(row)"></tr>

			<!-- Row shown when there is no matching data. -->
			<tr class="mat-row" *matNoDataRow>
				<td class="mat-cell" colspan="8">No data matching the filter "{{input.value}}"</td>
			</tr>
		</table>
		<mat-paginator [pageSizeOptions]="[5, 10, 25, 100]"></mat-paginator>
	</div>
</div>